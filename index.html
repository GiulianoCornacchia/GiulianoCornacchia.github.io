<!DOCTYPE html>
<html lang="en">
  <head>
	
	
	<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	
	<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117906878-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117906878-1');
</script>

	
	
	<script type="text/javascript" src="maps.js"></script>
	<script type="text/javascript" src="grafici.js"></script>
	<script type="text/javascript" src="main_script.js"></script>
	<script type="text/javascript" src="sides_graph.js"></script>
	<script type="text/javascript" src="stats.js"></script>
	<script type="text/javascript" src="jscolor.js"></script>
	<script type="text/javascript" src="heatmap.js"></script>
	<script type="text/javascript" src="msp_graph.js"></script>
	<script type="text/javascript" src="my_chord.js"></script>
	<script type="text/javascript" src="my_popup.js"></script>
	<link href="./lib/nouislider.min.css" rel="stylesheet">
	
   

  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

	<link rel="stylesheet" href="./lib/jquery-ui.css">
	<link rel="stylesheet" href="./lib/style(1).css">
	<script src="./lib/nouislider.min.js"></script>
	<script src="./lib/jquery-1.12.4.js.download"></script>
	<script src="./lib/jquery-ui.js.download"></script>
	<script src="names.js"></script>
  
	<link href="my_style.css" rel="stylesheet" type="text/css">
  
    <meta charset="utf-8">
    <title>NBA shots analytics</title>

	<script src="https://d3js.org/d3.v4.min.js"></script>
  </head>
  <body>
   

   

   

   

 
 
 
 
 
	<script type="text/javascript">

	
	x=getPar_year()
	
	if(x==undefined)
	x=2014
		
	read_data("./dataset_pc/"+x+"/most_similar_players.csv",
			  "./dataset_pc/"+x+"/total_assist.csv",
			  "./dataset_pc/"+x+"/total_defenders.csv",
			  "./dataset_pc/"+x+"/name_to_team.csv")
	
  
	
	</script>


	
<div class="container-fluid">

	 <div class="row">	
	
			 
		<div class="col-md-4 "> 
				<div id="welcome"> <h1>NBA Shot Analytics </h1><h5><b>by Giuliano Cornacchia</b></h5> <h5>Select a player from the similarity graph or using the search bar. </h5></div> <div id="graph"> </div> <div id="info_player"> </div> 
		</div>
		

		
		<div class="col-md-5 padding-0"> <div id="msp"> </div> </div>
		
		<div class="col-md-3">
			<div class="col-md-5 padding-0">
				<select name="years" onchange="fun1(this.value)" id="anno">
					<option value="2014">Season 14/15</option>
					<option value="2017">Season 17/18</option>
				</select>	
			</div>
			<div class="col-md-7 padding-0">
				<div id="search">
					<div class="ui-widget">
						<input id="tags" style="height:20px; width:190px" type="text" spellcheck="false" placeholder="Search a player..">
					</div> 
				</div>
		  </div>			
		</div>

		
		
   </div>
	
	<div class="row ">

		<div class="col-md-4 "> 
		<div class="row"> 
			<div class="col-md-12 padding-0"> <div id="b"> </div>	 </div>	 
		</div>	
		 <div class="row">
			 <div class="col-md-2 padding-0">	<div id="min"></div>	 </div>	
			 <div class="col-md-8">	<div id="range"> </div>	 </div>	 
			 <div class="col-md-2 padding-0">	<div id="max"></div>	 </div>	
		 </div>
		</div>
		
		
		
		
		<div class="col-md-1 padding-0">	<div id="filter_menu">

  <button id="b_play" style="position: absolute; bottom:0px; height:25px;" onclick="play()">&#9658;</button>
  <button id="b_stop"  style="position: absolute;bottom:0px; left:33px; height:25px;"  onclick="stop()">&#9632;</button>
  <button id="b_pause" style="position: absolute;bottom:0px; left:60px; height:25px;"  onclick="pause()">&#10074;&#10074;</button>
  <i><b>NBA </b></i>

  <b> Stats: </b>
  <br>
  <div id="pct">
  </div>
  <br>

  <b> Filters: </b>
  <br>
  <input  type="checkbox" id="made" value="made" checked="checked"/> made

 <input type="checkbox" id="miss" value="miss" checked="checked"/> miss
 <br>
 <input type="checkbox" id="pnt2" value="2pnt" checked="checked"/> 2 pnt

 <input type="checkbox" id="pnt3" value="3pnt" checked="checked"/> 3 pnt
  <br>
</div>
		</div>
		<div class="col-md-7">
			<div class="row">
				<div class="col-md-6">
					<div class="row">
						<div class="col-md-12">		<div class="grafico_" id="grafico"> </div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-12">		<div class="grafico_" id="grafico2"> </div>
						</div>
					</div>
				</div>
				<div class="col-md-6">
					<div class="row">
						<div class="col-md-12">		<div class="grafico_" id="grafico3"> </div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-12">		<div class="grafico_" id="grafico4"> </div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col-md-4 padding-0">	
     <div id="heatmapContainerWrapper">
	    <div id="heatmapContainer" >  
	        </div> <div id="bb"> </div> 
	 </div>
 
		</div>
		<div class="col-md-4">	<div id="chord"></div>	<input id="foo" class="jscolor {mode:'HVS'}" onchange="update_color(this.jscolor)" value="cc4499" style="height:0px; width:0px; border-width:0px">
		</div>
		<div class="col-md-4">	<div id="radar"> </div>
		</div>
	</div>
	
	<div class="row">
		<div class="col-md-9 padding-0">	  
		</div>
		<div class="col-md-3 padding-0"> <b>NBA</b> shots analytics by <b><i><a href="https://www.facebook.com/giuliano.cornacchia">Giuliano Cornacchia</a></i></b>
		</div>
	</div>
</div>



	

<script>
window.onresize = function(event) {
    update()
};


current_year=2014

function fun1(val)
{
	set_tags(val)
	current_year=val
	console.log("changed "+current_year)
	
	d3.csv("./dataset_pc/"+current_year+"/most_similar_players.csv", function(data){
	most_similar_player = data
	build_graph(data,[])
	graph_active=1
}
);

	d3.csv("./dataset_pc/"+current_year+"/most_similar_players.csv", function(data){ most_similar_player = data});
	console.log("most_similar_player loaded")
	
	d3.csv("./dataset_pc/"+current_year+"/total_assist.csv", function(data){total_assist = data});
	console.log("total_assist loaded")
	
	d3.csv("./dataset_pc/"+current_year+"/name_to_team.csv", function(data){name_to_team = data});
	console.log("name_to_team loaded")
	

	d3.csv("./dataset_pc/"+current_year+"/total_defenders.csv", function(data){total_defender = data		
	});

}


filter_flag=[]
for(i=0;i<5;i++)
filter_flag[i]=true

$('#tags').keypress(function (e){

if(e.which==13)
{
console.log(tags.value)
setURL(tags.value)
update()
set_tags(current_year)
}

});

$('#tags').click(function (e){

tags.value=""

});



$('#filter_menu :checkbox').change(function () {
   
   if($(this).val()=="made")
     index = 0;
    if($(this).val()=="miss")
     index = 1;
    if($(this).val()=="2pnt")
     index = 2;
    if($(this).val()=="3pnt")
     index = 3;
	if($(this).val()=="assisted")
     index = 4;
   
    filter_flag[index]=$(this).is(':checked')
   
   draw_shotchart("",true,q1,m1,q2,m2,500,350,filter_flag,true,"vis")
  
   
   
});


var q1
var q2
var m1
var m2



var startSlider = document.getElementById('range');

noUiSlider.create(startSlider, {
	start: [0, 52],
	width: "200px",
	//tooltips: [ true, true ],
	connect: true,
	step: 1,
	range: {
		'min': [ 0 ],
		'max': [ 65 ]
	}
});



var paddingMin = document.getElementById('min'),
	paddingMax = document.getElementById('max');
	


startSlider.noUiSlider.on('update', function ( values, handle ) {
	if ( handle ) {
	    
		q2 = parseInt(values[handle]/13)+1;
	    m2 = (13*q2)-values[handle]-1
		
		if(values[handle]==52)
		{
		  q2 = 4;
		  m2=0;
		}
		
	    var str1 = ''+q2+'-'+m2+':00'
		paddingMax.innerHTML = str1;
		
	
	} else {
	q1 = parseInt(values[handle]/13)+1;
	m1 = (13*q1)-values[handle]-1
	
	if(values[handle]==52)
		{
		  q1 = 4;
		  m1=0;
		}
	var str1 = ''+q1+'-'+m1+':00'
		paddingMin.innerHTML = str1;
		
	}
	
	//draw_shotchart("",true,,500,350,filter_flag,false,"vis")
	draw_shotchart("",true,q1,m1,q2,m2,500,350,filter_flag,false,"vis")

	
});

//init. button's state

document.getElementById("b_play").disabled = false;
document.getElementById("b_pause").disabled = true;
document.getElementById("b_stop").disabled = true;


var min_play = -2
var incr=1
var init=1


function play()
{
	
	document.getElementById("b_play").disabled = true;
	document.getElementById("b_pause").disabled = false;
	document.getElementById("b_stop").disabled = false;
	
	if(init==1)
	{
		init = 0
		interval_play = setInterval(p,1000);		
	}
	
	incr=1
	
}

function stop()
{
	document.getElementById("b_play").disabled = false;
	document.getElementById("b_pause").disabled = true;
	document.getElementById("b_stop").disabled = true;
	
	clearInterval(interval_play);
	draw_shotchart("",true,0,0,7,0,500,350,filter_flag,false,"stop")
	draw_shotchart("",true,0,0,7,0,500,350,filter_flag,true,"vis")
	
	init = 1;
	min_play = -2
	
}

function pause()
{
	document.getElementById("b_play").disabled = false;
	document.getElementById("b_pause").disabled = true;
	document.getElementById("b_stop").disabled = false;
	
	draw_shotchart("",true,0,0,7,0,500,350,filter_flag,false,"pause")
	incr = 0;
	
}


function p()
{
	q2 = parseInt(min_play/13)+1;
	m2 = (13*q2)-min_play-1
	

	console.log("Partiti")
	
	draw_shotchart("",true,0,0,q2,m2,500,350,filter_flag,false,"play")
	
		
	min_play=min_play+incr;
	
	
	if(min_play==62)
	   clearInterval(interval_play);
	
}






</script>



	
	
	
	
	
  </body>
</html>
